FROM debian:bookworm-slim

RUN apt-get update && apt-get install -y \
    curl \
    dnsutils \
    jq \
    ca-certificates \
    --no-install-recommends && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /tests
COPY . .

# YENİ SATIR: entrypoint'i de kopyala ve izin ver
RUN chmod +x test-runner.sh helpers.sh scenarios/*.sh entrypoint.sh

# YENİ SATIR: Konteyner başladığında bu script'i çalıştır
ENTRYPOINT ["/tests/entrypoint.sh"]

# ENTRYPOINT, CMD'yi argüman olarak alır. Bu, 'tail -f /dev/null' komutunun
# sertifika kurulumundan SONRA çalışmasını sağlar.
CMD ["tail", "-f", "/dev/null"]